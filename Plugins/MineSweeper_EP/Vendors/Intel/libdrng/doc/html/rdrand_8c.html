<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>DRNG Library: C:/Users/johnm/Documents/For ProtexIP/libdrng-1.0/rdrand.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">DRNG Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('rdrand_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">C:/Users/johnm/Documents/For ProtexIP/libdrng-1.0/rdrand.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>APIs for rdrand functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="drng_8h_source.html">drng.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af7b2fee6da8e44ce8d6a0e4a5262d079"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#af7b2fee6da8e44ce8d6a0e4a5262d079">RDRAND_MASK</a>&#160;&#160;&#160;0x40000000</td></tr>
<tr class="separator:af7b2fee6da8e44ce8d6a0e4a5262d079"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4eba3b0ea03f397bae8792d0f0e4cd4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad4eba3b0ea03f397bae8792d0f0e4cd4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>RETRY_LIMIT</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ad4eba3b0ea03f397bae8792d0f0e4cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:acd2b4a4f9b95333d55673ab3b5a879c6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd2b4a4f9b95333d55673ab3b5a879c6"></a>
typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><b>_wordlen_t</b></td></tr>
<tr class="separator:acd2b4a4f9b95333d55673ab3b5a879c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a092ff5b5cdd0009b9a39bd9a087e5ee8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#a092ff5b5cdd0009b9a39bd9a087e5ee8">RdRand_cpuid</a> ()</td></tr>
<tr class="memdesc:a092ff5b5cdd0009b9a39bd9a087e5ee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries cpuid to see if rdrand is supported and caches the result.  <a href="#a092ff5b5cdd0009b9a39bd9a087e5ee8">More...</a><br /></td></tr>
<tr class="separator:a092ff5b5cdd0009b9a39bd9a087e5ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e99256bfc3ab954115658e09ff0b7c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#a53e99256bfc3ab954115658e09ff0b7c">RdRand_isSupported</a> ()</td></tr>
<tr class="memdesc:a53e99256bfc3ab954115658e09ff0b7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determines whether or not rdrand is supported by the CPU.  <a href="#a53e99256bfc3ab954115658e09ff0b7c">More...</a><br /></td></tr>
<tr class="separator:a53e99256bfc3ab954115658e09ff0b7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b6836005a9eeaa7fc22e8ec128da4c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#ac0b6836005a9eeaa7fc22e8ec128da4c">rdrand_16</a> (uint16_t *x, int retry)</td></tr>
<tr class="memdesc:ac0b6836005a9eeaa7fc22e8ec128da4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls rdrand for a 16-bit result.  <a href="#ac0b6836005a9eeaa7fc22e8ec128da4c">More...</a><br /></td></tr>
<tr class="separator:ac0b6836005a9eeaa7fc22e8ec128da4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5322e4aa5e55c40875b980638726001"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#ae5322e4aa5e55c40875b980638726001">rdrand_32</a> (uint32_t *x, int retry)</td></tr>
<tr class="memdesc:ae5322e4aa5e55c40875b980638726001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls rdrand for a 32-bit result.  <a href="#ae5322e4aa5e55c40875b980638726001">More...</a><br /></td></tr>
<tr class="separator:ae5322e4aa5e55c40875b980638726001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a226c1c992d91231a6d0c374b3ccb3f44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#a226c1c992d91231a6d0c374b3ccb3f44">rdrand_get_n_32</a> (unsigned int n, uint32_t *dest)</td></tr>
<tr class="memdesc:a226c1c992d91231a6d0c374b3ccb3f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls rdrand to obtain multiple 32-byte results.  <a href="#a226c1c992d91231a6d0c374b3ccb3f44">More...</a><br /></td></tr>
<tr class="separator:a226c1c992d91231a6d0c374b3ccb3f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1908b1f4b65c4dabc7cfdff97b488095"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="rdrand_8c.html#a1908b1f4b65c4dabc7cfdff97b488095">rdrand_get_bytes</a> (unsigned int n, unsigned char *dest)</td></tr>
<tr class="memdesc:a1908b1f4b65c4dabc7cfdff97b488095"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls rdrand to fill a buffer of arbitrary size with random bytes.  <a href="#a1908b1f4b65c4dabc7cfdff97b488095">More...</a><br /></td></tr>
<tr class="separator:a1908b1f4b65c4dabc7cfdff97b488095"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a916c4bedfe2bbef01c3d59b6426d2492"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a916c4bedfe2bbef01c3d59b6426d2492"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>rdrand_support_cache</b> = <a class="el" href="drng_8h.html#a203fff519a3359db63b6f734c41ae29d">DRNG_SUPPORT_UNKNOWN</a></td></tr>
<tr class="separator:a916c4bedfe2bbef01c3d59b6426d2492"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>APIs for rdrand functions. </p>
<p>This is the rdrand library file which exposes different APIs for 32- and 64-bit systems. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="af7b2fee6da8e44ce8d6a0e4a5262d079"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RDRAND_MASK&#160;&#160;&#160;0x40000000</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The bit mask used to examine the ecx register returned by cpuid. The 30th bit is set. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ac0b6836005a9eeaa7fc22e8ec128da4c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rdrand_16 </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>retry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls rdrand for a 16-bit result. </p>
<p>This function calls rdrand requesting a 16-bit result. By default, it will perform only a single call to rdrand, returning success or failure. On success, the data is written to memory pointed to by x. On failure an error is returned unless the int retry is true (non-zero), in which case the function will retry rdrand up to 10 times for a successful result before returning an error.</p>
<p>This function also ensures that rdrand is supported by the cpu or fails gracefully.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>pointer to memory to store the random result </td></tr>
    <tr><td class="paramname">retry</td><td>int to determine whether or not to loop until rdrand succeeds or until 10 failed attempts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the call was successful, or supported at all </dd></dl>

</div>
</div>
<a class="anchor" id="ae5322e4aa5e55c40875b980638726001"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rdrand_32 </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>retry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls rdrand for a 32-bit result. </p>
<p>This function calls rdrand requesting a 32-bit result. By default, it will perform only a single call to rdrand, returning success or failure. On success, the data is written to memory pointed to by x. On failure an error is returned unless the int retry is true (non-zero), in which case the function will retry rdrand up to 10 times for a successful result before returning an error.</p>
<p>This function also ensures that rdrand is supported by the cpu or fails gracefully.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>pointer to memory to store the random result </td></tr>
    <tr><td class="paramname">retry</td><td>int to determine whether or not to loop until rdrand succeeds or until 10 failed attempts</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the call was successful, or supported at all </dd></dl>

</div>
</div>
<a class="anchor" id="a092ff5b5cdd0009b9a39bd9a087e5ee8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RdRand_cpuid </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queries cpuid to see if rdrand is supported and caches the result. </p>
<p>rdrand support in a CPU is determined by examining the 30th bit of the ecx register after calling cpuid.</p>
<dl class="section return"><dt>Returns</dt><dd>bool of whether or not rdrand is supported </dd></dl>

</div>
</div>
<a class="anchor" id="a1908b1f4b65c4dabc7cfdff97b488095"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rdrand_get_bytes </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls rdrand to fill a buffer of arbitrary size with random bytes. </p>
<p>This function calls rdrand requesting multiple 64- or 32-bit results to fill a buffer of arbitrary size.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>size of the buffer to fill with random bytes </td></tr>
    <tr><td class="paramname">buffer</td><td>pointer to memory to store the random result</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>whether or not the call was successful, or supported at all </dd></dl>

</div>
</div>
<a class="anchor" id="a226c1c992d91231a6d0c374b3ccb3f44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rdrand_get_n_32 </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls rdrand to obtain multiple 32-byte results. </p>
<p>This function calls rdrand requesting multiple 32-byte results. On success, the data is written to memory pointed to by x. This function calls rdrand_32 and if any of those invocations fail, this function fails. It returns the same values as rdrand_32.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>total number of 32-bit random values to generate </td></tr>
    <tr><td class="paramname">x</td><td>pointer to memory buffer to fill with 32-bit random values </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a53e99256bfc3ab954115658e09ff0b7c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int RdRand_isSupported </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determines whether or not rdrand is supported by the CPU. </p>
<p>This function calls cpuid to determine rdrand support and caches the result in a static variable. This prevents calling cpuid on subsequent invocations.</p>
<dl class="section return"><dt>Returns</dt><dd>bool/int of whether or not rdrand is supported </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="rdrand_8c.html">rdrand.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
